<!-- print.view -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<title>A Primer on Python Metaclass Programming - O'Reilly Media</title>
	<meta name="keywords" content="Metaclasses,Python,type,David Mertz,advanced OOP.,O'Reilly Media" />
	<meta name="description" content="" />
	<meta name="date" content="Apr. 17, 2003" />
	<meta name="search_date" content="2003-04-17" />
	<meta name="pagename" content="A Primer on Python Metaclass Programming" />
	<meta name="site" content="O'Reilly Media Inc." />
	<meta name="subtitle" content="" />
	<meta name="author" content="David Mertz" />
<meta name="target" content="" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:title" content="A Primer on Python Metaclass Programming" />
	<meta name="twitter:description" content="" />
	<meta name="twitter:site" content="@OReillyMedia" />
	<meta name="twitter:url" content="http://www.windowsdevcenter.com/pub/a/python/2003/04/17/metaclasses.html" />


<!-- sc/388 Common JavaScript -->
<script language="JavaScript" type="text/javascript" src="/common.js"></script>

<link rel="stylesheet" type="text/css" href="/styles/main.css" />
<link rel="stylesheet" type="text/css" href="http://cdn.oreillystatic.com/oreilly/ml/css/stylesheet.css" />
<link rel="stylesheet" type="text/css" href="http://cdn.oreillystatic.com/oreilly/ml/css/ml-special.css" />

<script language="JavaScript" type="text/javascript"><!--
var s_account="ornetwork,orglobal"
//--></script>
<!-- SiteCatalyst code version: H.20.2. Copyright 1997-2009 Omniture, Inc. More info available at http://www.omniture.com  -->
<script language="JavaScript" type="text/javascript" src="http://cdn.oreillystatic.com/assets/js/s_code.js"></script>
<script language="JavaScript" type="text/javascript"><!--
s.pageName="network:onlamp:a primer on python metaclass programming"
s.channel="network"
s.prop1="network:onlamp"
s.prop2="network:onlamp"
s.prop3="network:onlamp"
s.prop4="article"
s.prop5="a primer on python metaclass programming"
s.prop6="n/a/3388"
s.prop24="04/17/2003"
s.prop21="david mertz"
s.hier1="network,onlamp"
/************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
var s_code=s.t();if(s_code)document.write(s_code)//--></script>
<!-- End SiteCatalyst code version: H.20.2. -->



<script type="text/javascript" src="/tabber.js"></script>

<!-- additional css -->
<link rel="stylesheet" type="text/css" href="/styles/articles.css" />

<!-- MyBuys libraries and style sheet -->
<link href="http://t.p.mybuys.com/css/mbstyles.css" type="text/css" rel="stylesheet" id="mybuysstyles" />
<script type="text/javascript" src="http://t.p.mybuys.com/js/mybuys3.js"></script>
<script type="text/javascript" src="http://t.p.mybuys.com/clients/OREILLY/js/setup.js"></script>
<!-- End MyBuys libraries and style sheet -->

</head>
<body id="onlamp">

<noindex>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="bottom"><!-- top left logo --><img src="/images/python/onlamp_python.gif" alt="Python DevCenter" width="240" height="88" border="0" usemap="#logo" />

<map name="logo">
<area shape="rect" coords="79,33,238,85" href="http://www.onlamp.com/python">
<area shape="rect" coords="78,1,246,35" href="http://www.onlamp.com">
</map></td>
</tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td colspan="2" valign="top">
<!-- tabs (generic) --><div id="tabs">
<div class="noindex" style="white-space:nowrap;float:left;width:435px;"><a href="http://www.oreilly.com/"><img src="/images/tabs/ora_gray.gif" alt="oreilly.com" width="82" height="16" hspace="0" vspace="0" border="0" /></a><a href="http://www.safaribooksonline.com/?utm_source=oreilly&utm_medium=referral&utm_campaign=publisher&utm_content=nav"><img src="/images/oreilly/safaribooksonline_gray.gif" alt="Safari Books Online." width="114" height="16" hspace="0" vspace="0" border="0" /></a><a href="http://www.oreilly.com/conferences/"><img src="/images/tabs/conf_gray.gif" alt="Conferences." width="88" height="16" hspace="0" vspace="0" border="0" /></a></div>
</div></td>
</tr>
<!-- search -->
<tr>
<td id="search2" class="v2" style="background-color: #006666;">
<div id="search-box" class="yui-skin-sam"> 

<form name="searchform" method="get" id="search-form" action="http://search.oreilly.com/"><div class="search">  
    <fieldset>  
        <span id="search-input">    
            <div class="searchInput">  
            <span id="search-field"><input autocomplete="off" class="yui-ac-input" value="" name="q" maxlength="200" id="q" onfocus="this.value=checkIfDefault(this.value);" type="text"></span>
            </div>  
            <span id="search-button"><input value="SEARCH" src="http://cdn.oreillystatic.com/images/oreilly/large-search.png" style="float:left" alt="search" align="top" border="0" type="image"></span>
        </span>  
        <div class="yui-ac-container" id="autocomplete"><div style="display: none;" class="yui-ac-content"><div style="display: none;" class="yui-ac-hd"></div><div class="yui-ac-bd"><ul><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li></ul></div><div style="display: none;" class="yui-ac-ft"></div></div></div>  
    </fieldset>    
</div></form>  
</div>
</td>
</tr>
<!-- Leaderboard 728 x 90 -->
<tr>
<td colspan="2" align="center" bgcolor="#efefef" style="padding: 6px;">
<!--JavaScript Tag // Tag for network 5159: TechVertical // Website: OR - ONLamp // Page: ONLamp // Placement: ros_728x90 (425849) // created at: Oct 9, 2008 5:51:41 PM-->
<script language="javascript"><!--
document.write('<scr'+'ipt language="javascript1.1" src="http://adserver.adtechus.com/addyn/3.0/5159/425849/0/225/ADTECH;loc=100;target=_blank;key=key1+key2+key3+key4;grp=[group];misc='+new Date().getTime()+'"></scri'+'pt>');
//-->
</script><noscript><a href="http://adserver.adtechus.com/adlink/3.0/5159/425849/0/225/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" target="_blank"><img src="http://adserver.adtechus.com/adserv/3.0/5159/425849/0/225/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" border="0" width="728" height="90"></a></noscript>

<!-- End of JavaScript Tag --><br />
<img src="/images/ads/advertisement.gif" width="120" height="10" border="0" alt="advertisement" />
</td>
</tr>
</table>
</noindex>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td width="160" rowspan="3" valign="top" bgcolor="#000000" style="border-left: 1px #FFF solid;">
<noindex>
<!-- begin left navbar -->
<table width="160" border="0" cellpadding="0" cellspacing="0" bgcolor="#000000">
<tr>
<td colspan="2" bgcolor="#000000"><img src="/images/trans.gif" alt=" " width="160" height="6" border="0" /></td>
</tr>
<tr>
<td valign="top" bgcolor="#000000" width="10"><img src="/images/trans.gif" alt="" width="10" height="10" border="0" /></td>
<td valign="top" bcolor="#000000" width="150" class="nav3">
<!-- python content -->
<p class="navheader" style="margin: 0px;">Content</p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/pub/q/all_python_articles" class="nav3">All Articles</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/pub/ct/16" class="nav3">Python News</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/pub/ct/12" class="nav3">Numerically Python</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.xml.com/pub/q/pyxml" class="nav3">Python &amp; XML</a></p>
<br />

<!-- python topics -->
<span class="navheader">Python Topics<br />
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/community" class="nav3">Community</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/database" class="nav3">Database</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/distributed" class="nav3">Distributed</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/education" class="nav3">Education</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/getting_started" class="nav3">Getting Started</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/graphics" class="nav3">Graphics</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/internet" class="nav3">Internet</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/os" class="nav3">OS</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/programming" class="nav3">Programming</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/scientific" class="nav3">Scientific</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/tools" class="nav3">Tools</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/tutorials" class="nav3">Tutorials</a></p><p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="/topics/python/user_interfaces" class="nav3">User Interfaces</a></p><br />
<!-- onlamp subjects -->
<p class="navheader" style="margin: 0px;">ONLamp Subjects</p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.linuxdevcenter.com/" class="nav3">Linux</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/apache/" class="nav3">Apache</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/general/mysql.html" class="nav3">MySQL</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.perl.com" class="nav3">Perl</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/php/" class="nav3">PHP</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/python/" class="nav3">Python</a></p>
<p class="nav3" style="margin: 0px 4px 0px 12px; text-indent: -12px; padding-left: 8 px;"><a href="http://www.onlamp.com/bsd/" class="nav3">BSD</a></p></td>
</tr>
</table>
<!-- end left navbar -->
</noindex>
</td>

<td width="10"><!-- space between left nav and tiles/lede area -->
<img src="/images/trans.gif" alt=" " width="10" height="1" border="0" /></td>

<td width="100%" valign="top">
<img src="/images/trans.gif" height="6" width="1" border="0" alt="" /><br />
<div id="article">

<!-- feature bar ad : layout component 1894 -->

<div align="center" style="visibility: hidden">
<!-- begin ad tag -->

<!--JavaScript Tag // Tag for network 5159: TechVertical // Website: O'ReillyNet // Page: O'ReillyNet // Placement: text (425846) // created at: Oct 9, 2008 6:10:33 PM-->
<script language="javascript"><!--
document.write('<scr'+'ipt language="javascript1.1" src="http://adserver.adtechus.com/addyn/3.0/5159/425846/0/16/ADTECH;loc=100;target=_blank;key=key1+key2+key3+key4;grp=[group];misc='+new Date().getTime()+'"></scri'+'pt>');
//-->
</script><noscript><a href="http://adserver.adtechus.com/adlink/3.0/5159/425846/0/16/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" target="_blank"><img src="http://adserver.adtechus.com/adserv/3.0/5159/425846/0/16/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" border="0" width="1" height="1"></a></noscript>
<!-- End of JavaScript Tag -->


<!-- End ad tag -->
</div>

<!-- end feature bar ad -->
<br />

<!-- begin content-->









<!-- begin  print-discuss-del.icio.us options -->
<div style="margin: 0px 10px 0px 6px;">
<div style="float: right; width: 170px;">

<a class="print" title="Go to a print-friendly version of this page." href="/lpt/a/3388">Print</a>
<!--csif cond="yes">
<a class="discuss" title="Join the talkback discussion about this article" href="/pub/a/python/2003/04/17/metaclasses.html?page=last#thread">Discuss</a>
</csif-->







<a class="subscribe" title="Subscribe" href="http://www.oreillynet.com/pub/feed/13">Subscribe to Python</a>
















<a class="newsletter" href="http://www.oreillynet.com/cs/nl/home">Subscribe to Newsletters</a>

<div id="share-options" style="text-align:right;">
<script type="text/javascript" src="http://w.sharethis.com/button/sharethis.js#publisher=16098316-763b-41fc-a31d-7bbadcfcf894&amp;type=website&amp;embeds=true&amp;style=rotate&amp;send_services=email%2Caim%2Csms&amp;post_services=twitter%2Cfriendfeed%2Cfacebook%2Cdigg%2Cdelicious%2Creddit%2Cslashdot%2Cgoogle_bmarks%2Cblogger%2Ctypepad%2Cstumbleupon%2Cwordpress%2Cwindows_live%2Cnewsvine%2Clinkedin%2Cmyspace%2Ctechnorati"></script>
</div>

</div>
</div>
<!-- end  print-discuss-del.icio.us options -->





<!-- content here -->














































	<!-- mega preparse mp:yes -->

<h2>
A Primer on Python Metaclass Programming</h2>
by <a href="/pub/au/1190">David Mertz</a><br />
04/17/2003


<p> <i>This series of articles by David Mertz assumes readers have a familiarity
with basic object-oriented programming concepts: inheritance, encapsulation, and
polymorphism. We pick up where the basics leave off; how some "exotic"
techniques can make applied programming tasks easier, more maintainable, and just
plain more elegant.  This series will primarily present examples in Python, but
the concepts apply to other programming languages too.  </p>

<!--ONJava MPU Ad -->


<div style="float:right;width:300px;padding-left:15px;">
<!--JavaScript Tag // Tag for network 5159: TechVertical // Website: OR - ONLamp // Page: ONLamp // Placement: ros_300x250 (425847) // created at: Oct 9, 2008 5:51:40 PM-->
<script language="javascript"><!--
document.write('<scr'+'ipt language="javascript1.1" src="http://adserver.adtechus.com/addyn/3.0/5159/425847/0/170/ADTECH;loc=100;target=_blank;key=key1+key2+key3+key4;grp=[group];misc='+new Date().getTime()+'"></scri'+'pt>');
//-->
</script><noscript><a href="http://adserver.adtechus.com/adlink/3.0/5159/425847/0/170/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" target="_blank"><img src="http://adserver.adtechus.com/adserv/3.0/5159/425847/0/170/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" border="0" width="300" height="250"></a></noscript>
<!-- End of JavaScript Tag -->
</div>


<!-- Digital Media MPU Ads -->





<p> This first installment examines </i>metaclasses<i>.  Just as ordinary
instances (objects) are built out of classes, classes themselves are built out
of metaclasses. Most of the time, you do not need to worry about the implicit
metaclass (named <code>type</code> in Python) that is used in class
construction, but occasionally, deliberate control of a class' metaclass can
produce powerful effects. For example, metaclasses allow "aspect oriented
programming," meaning you can enhance classes with features like tracing
capabilities, object persistence, exception logging, and more.</i>  </p>

<h3>An Object-Oriented Programming Review</h3>

<!--
<csperl file="set_book_cover_image">
-->

<!-- sidebar begins -->
<table width="140" border="1" cellspacing="2" cellpadding="10" align="right" style="border: 1px solid #333333; margin: 8px;"><tr>
<td width="140" valign="top" bgcolor="#ffffff" style="border: none;">
<p class="headline">Related Reading</p>
<!--
<csif perl="$cfg->vars('cover_image_url_base')">
-->
<a href="http://shop.oreilly.com/product/9780596001889.do?CMP=ILL-4GV796923290">

<img src="http://covers.oreilly.com/images/9780596001889/cat.gif">

<!--

<csperl>print $cfg->vars('cover_image_url_cat');</csperl>
-->
</a>
<!--
</csif>
-->
<p class="medlist"><span class="title"><a href="http://shop.oreilly.com/product/9780596001889.do">Python in a Nutshell</a></span><strong><br />

By <a href="http://www.oreillynet.com/pub/au/918">Alex Martelli</a></strong>
</p>
<div class="secondary">
<!-- builds links to list in sidebar -->
<!--csperl>
    my @links = split(/(?:\r?\n)+/, ( $DATA{"supporting_links"} || "" ));
    for my $link ( @links ) {
	my ( $name, $url ) = split /=/, $link, 2;	
	next unless $name and $url;
	$url = "http://shop.oreilly.com/product/$DATA{'reference'}.do$url" unless $url =~ /^\w+:/os;
$url = $url . "?CMP=ILL-4GV796923290";
        if ($name =~ /Table of Contents/) {
           print qq~ <a href="$url">$name</a><br /> \n ~;
        } elsif ($name =~ /Index/) {
           print qq~ <a href="$url">$name</a><br /> \n ~;
        } elsif ($name eq "Author's Article") {
           print qq~ <a href="$url">$name</a><br /> \n ~;
        } elsif ($name =~ /Sample Chapter/) {
           print qq~ <a href="$url">$name</a><br /> \n ~;
        } else {
           print qq~\n~;
        }
    }
</csperl-->

</div>
</td>
</tr></table>
<!-- sidebar ends -->


<p> In general principles, OOP works the same way across many programming
languages, modulo minor syntax differences. In an object-oriented programming
language, you can define <em>classes</em> that bundle together related data
and behavior.  These classes can inherit some or all of their qualities from
their <em>parents</em>, but can also define attributes (data) or methods
(behavior) of their own. Classes generally act as templates for the creation of
<em>instances</em> (or simply <em>objects</em>). Different instances of the
same class typically have different data but share the same "shape"--e.g.,
the <code>Employee</code> objects <code>bob</code> and <code>jane</code> both
have a <code>.salary</code> and a <code>.room_number</code>, but not the same
room and salary as each other.  </p>

<h3>A Metaprogramming Rejoinder</h3>

<p> In Python (and other languages), classes are themselves objects that can be
passed around and introspected.   Just as regular classes act as templates for
producing instances, metaclasses act as templates for producing classes.  </p>

<p> Python has always had metaclasses. The metaclass machinery became exposed much better  with Python 2.2.  Specifically, with version 2.2, Python stopped
being a language with just one special (mostly hidden) metaclass that created
every class object. Now, programmers can subclass the built-in metaclass
<code>type</code> and even dynamically generate classes with varying
metaclasses.  </p>

<p> You do not need to use custom metaclasses to manipulate the production of
classes, however.  A slightly less brain-melting concept is a <em>class
factory</em>.  An ordinary function can return a class that is dynamically
created within the function body.  In traditional Python syntax, you can write the following.
</p>

<h4>Example 1. An old-fashioned Python 1.5.2 class factory</h4>

<pre><code>Python 1.5.2 (#0, Jun 27 1999, 11:23:01) [...]
Copyright 1991-1995 Stichting Mathematisch Centrum, Amsterdam
&gt;&gt;&gt; def class_with_method(func):
...     class klass: pass
...     setattr(klass, func.__name__, func)
...     return klass
...
&gt;&gt;&gt; def say_foo(self): print 'foo'
...
&gt;&gt;&gt; Foo = class_with_method(say_foo)
&gt;&gt;&gt; foo = Foo()
&gt;&gt;&gt; foo.say_foo()
foo</code></pre>

<p> The factory function <code>class_with_method()</code> dynamically creates
and returns a class that contains the method/function passed into the factory.
The class itself is manipulated within the function body before being returned.
The <strong><code>new</code></strong> module provides a more concise spelling,
but without the same options for custom code within the body of the class
factory: </p>

<h4>Example 2. A class factory in the <code><strong>new</strong></code>
module</h4>

<pre><code>&gt;&gt;&gt; from new import classobj
&gt;&gt;&gt; Foo2 = classobj('Foo2',(Foo,),{'bar':lambda self:'bar'})
&gt;&gt;&gt; Foo2().bar()
'bar'
&gt;&gt;&gt; Foo2().say_foo()
foo</code></pre>

<p> In all of these cases, the behaviors of the class (<code>Foo</code>,
<code>Foo2</code>) are not directly written as code, but are instead created by
calling functions at runtime, with dynamic arguments.  Not only are the
<em>instances</em> dynamically created, so are the <em>classes</em> themselves.
</p>

<h3>From Class Factories to Metaclasses</h3>

<p> Methods (i.e., of classes), like plain functions, can return objects. In
that sense, it is obvious that class factories can be classes just as easily as
they can be functions. In particular, Python 2.2+ provides a special class
called <code>type</code> that is just such a class factory. The new class
<code>type</code> is backwards-compatible with the older function of the same
name, by the way. The class <code>type</code> works as a class factory in the
same way that the function <code>new.classobj</code> does: </p>

<h4>Example 3. <code>type</code> as a class factory metaclass</h4>

<pre><code>&gt;&gt;&gt; X = type('X',(),{'foo':lambda self:'foo'})
&gt;&gt;&gt; X, X().foo()
(&lt;class '__main__.X'&gt;, 'foo')</code></pre>

<p> Since <code>type</code> is now a (meta)class, you are free to subclass it:
</p>

<h4>Example 4. A <code>type</code> descendent as class factory</h4>

<pre><code>&gt;&gt;&gt; class ChattyType(type):
...     def __new__(cls, name, bases, dct):
...         print "Allocating memory for class", name
...         return type.__new__(cls, name, bases, dct)
...     def __init__(cls, name, bases, dct):
...         print "Init'ing (configuring) class", name
...         super(ChattyType, cls).__init__(name, bases, dct)
...
&gt;&gt;&gt; X = ChattyType('X',(),{'foo':lambda self:'foo'})
Allocating memory for class X
Init'ing (configuring) class X
&gt;&gt;&gt; X, X().foo()
(&lt;class '__main__.X'&gt;, 'foo')</code></pre>

<p> The magic methods <code>.__new__()</code> and <code>.__init__()</code> are
special, but in conceptually the same way that they are for any other class. The
<code>.__init__()</code> method lets you configure the created object and the
<code>.__new__()</code> method lets you customize its allocation. The latter is
not widely overridden, but does exist for every Python 2.2 new-style class.
</p>

<p> There is one feature of <code>type</code> descendents to be careful about;
it catches everyone who first plays with metaclasses.  The first argument to
methods is conventionally called <code>cls</code> rather than
<code>self</code>, because the methods operate on the <em>produced</em> class,
not the metaclass.  Actually, there is nothing special about this.  All methods
attach to their instances, and the instance of a metaclass is a class.  A
better name makes this more obvious: </p>

<h4>Example 5. Attaching class methods to produced classes</h4>

<pre><code>&gt;&gt;&gt; class Printable(type):
...     def whoami(cls): print "I am a", cls.__name__
...
&gt;&gt;&gt; Foo = Printable('Foo',(),{})
&gt;&gt;&gt; Foo.whoami()
I am a Foo
&gt;&gt;&gt; Printable.whoami()
Traceback (most recent call last):
TypeError:  unbound method whoami() [...]</code></pre>

<p> All of this surprisingly non-remarkable machinery comes with some syntax sugar
that both makes working with metaclasses easier and confuses new users.  There
are several elements to the extra syntax.  The resolution order of these new
variations is tricky though.  Classes can inherit metaclasses from their
ancestors--notice that this is <strong>not</strong> the same thing as
<em>having</em> metaclasses as ancestors (another common confusion).  For
old-style classes, defining a global <code>__metaclass__</code> variable can
force a custom metaclass to be used.  Most of the time, the safest approach is
to set a <code>__metaclass__</code> class attribute for a class that wants to
be created via a custom metaclass.  You must set the variable in the class
definition itself, since the metaclass is not used if the attribute is set later
(after the class object has already been created).  For example: </p>

<h4>Example 6. Setting a metaclass with a class attribute</h4>

<pre><code>&gt;&gt;&gt; class Bar:
...     __metaclass__ = Printable
...     def foomethod(self): print 'foo'
...
&gt;&gt;&gt; Bar.whoami()
I am a Bar
&gt;&gt;&gt; Bar().foomethod()
foo</code></pre>

<table id="page-break" width="100%" border="0" cellspacing="0" cellpadding="0" style="clear:left;"><tr><td><p class="secondary">
Pages: <b>1</b>, <a href="/pub/a/python/2003/04/17/metaclasses.html?page=2">2</a>
</p></td><td><p class="secondary" align="right">
<a href="/pub/a/python/2003/04/17/metaclasses.html?page=2">
Next Page<img src="/images/arrows/arrows-66.gif" border="0" alt="arrow" width="12" height="13" hspace="2" vspace="0" align="baseline"></a></p></td></tr></table>







<!-- end article content -->




<!-- end content -->


<img src="/images/trans.gif" alt=" " width="400" height="1" /><br />



<br /><br />


<!-- end content -->

</div><!-- #article -->

</td>

<td width="5" bgcolor="#ffffff"><!-- space between tiles/lede and web logs -->
<img src="/images/trans.gif" alt=" " width="5" height="1" border="0" /></td>
<td width="1" bgcolor="#cccccc"><!--vertical line between tiles/lede and weblogs -->
<img src="/images/trans.gif" alt=" " width="1" height="1" border="0" /></td>
<td width="8" bgcolor="#ffffff"><!-- space between tiles/lede and news -->
<img src="/images/trans.gif" alt=" " width="8" height="1" border="0" /></td>

<td width="170px" valign="top">

<table width="170px" border="0" cellspacing="0" cellpadding="4">
<tr>
<td>

<!-- MyBuys Zone and Parameters -->
<div class="sidebar-item">
<h3>Recommended for You</h3>
<div class="sidebar-item-content" style="text-align: center; padding: 0px;">

<!-- MyBuys Web Recommendation Zone -->
<div mybuyszone="5"></div>
<!-- End MyBuys Web Recommendation Zone -->


<!-- debug: type: content_item, cs cat: python, deli cat: python -->
<!-- MyBuys Page Parameters -->
<script type="text/javascript">
mybuys.setPageType("CONTENT_ITEM");
mybuys.set("categoryid","http://purl.oreilly.com/resource-center/python");
</script>
<!-- End MyBuys Page Parameters -->
		</div>
</div>
</td>
</tr>
</table><br />

</td>

<td width="10" valign="top"><!-- space between news and sponsors -->
<img src="/images/trans.gif" alt=" " width="10" height="1" border="0" /></td>
<td width="160" bgcolor="#efefef" valign="top" align="center" class="secondary" style="border-right: 1px #FFF solid; padding: 10px;">
<!-- Sponsors -->

<p class="smalllist" style="text-align:center">Sponsored by:</p>
<div align="center">
<div style="margin:2px 0 20px 0;padding:5px;">

<!--JavaScript Tag // Tag for network 5159: TechVertical // Website: OR - ONLamp // Page: ONLamp // Placement: ros_160x600 (425850) // created at: Oct 9, 2008 5:51:39 PM-->
<script language="javascript"><!--
document.write('<scr'+'ipt language="javascript1.1" src="http://adserver.adtechus.com/addyn/3.0/5159/425850/0/154/ADTECH;loc=100;target=_blank;key=key1+key2+key3+key4;grp=[group];misc='+new Date().getTime()+'"></scri'+'pt>');
//-->
</script><noscript><a href="http://adserver.adtechus.com/adlink/3.0/5159/425850/0/154/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" target="_blank"><img src="http://adserver.adtechus.com/adserv/3.0/5159/425850/0/154/ADTECH;loc=300;key=key1+key2+key3+key4;grp=[group]" border="0" width="160" height="600"></a></noscript>

<!-- End of JavaScript Tag -->
</div>
</div>

<br />
</td>
</tr>
</table>
<table width="100%"  border="0" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cccccc"><img src="/images/trans.gif" alt=" " border="0" height="1" width="1"></td>
</tr>
<tr>
<td>
<!-- MyBuys Page Initialization -->
<script type="text/javascript">
mybuys.initPage();
</script>
<!-- End MyBuys Page Initialization -->
			<div id="multiColumnFooter">
				<div id="footer-branding">
					<img src="//cdn.oreillystatic.com/images/sitewide-headers/logo02.gif" alt="O'reilly"/>
					<p class="copyright">&copy; 2017, O&#8217;Reilly Media, Inc.</p>
					<p>
						<span class="phone-number">(707) 827-7019</span>
						<span class="phone-number">(800) 889-8969</span>
					</p>
					<p class="trademarks">All trademarks and registered trademarks appearing on oreilly.com are the property of their respective owners.</p>
				</div>
				<div class="contentSectionBlock">
					<div class="contentSectionContainer" >
						<span id="footerColumn-1" class="contentSection">
							<h3>About O'Reilly</h3>
							<ul>
                                                                <li><a href="#" id="capture_signin_link" class="capture_modal_open footer">Sign In</a></li>
								<li><a class="footer" href="http://oreilly.com/academic/">Academic Solutions</a></li>
								<li><a class="footer" href="http://oreilly.com/jobs/">Jobs</a></li>
								<li><a class="footer" href="http://oreilly.com/contact.html">Contacts</a></li>
								<li><a class="footer" href="http://oreilly.com/about/">Corporate Information</a></li>
								<li><a class="footer" href="http://press.oreilly.com/index.html">Press Room</a></li>
								<li><a class="footer" href="http://oreilly.com/oreilly/privacy.csp">Privacy Policy</a></li>
								<li><a class="footer" href="http://oreilly.com/terms/">Terms of Service</a></li>
								<li><a class="footer" href="http://oreilly.com/oreilly/author/intro.csp">Writing for O'Reilly</a></li>
							</ul>
						</span>
					</div><!--end contentSectionContainer-->
					<div class="contentSectionContainer" >
						<span id="footerColumn-2" class="contentSection">
							<h3>Community</h3>
							<ul>
								<li><a class="footer" href="http://oreilly.com/authors/">Authors</a></li>
								<li><a class="footer" href="http://oreilly.com/community/">Community &amp; Featured Users</a></li>
								<li><a class="footer" href="http://forums.oreilly.com/">Forums</a></li>
								<li><a class="footer" href="https://members.oreilly.com/">Membership</a></li>
								<li><a class="footer" href="http://elists.oreilly.com/">Newsletters</a></li>
								<li><a class="footer" href="http://answers.oreilly.com/">O'Reilly Answers</a></li>
								<li><a class="footer" href="http://oreilly.com/feeds/">RSS Feeds</a></li>
								<li><a class="footer" href="http://ug.oreilly.com/">User Groups</a></li>
							</ul>
						</span>
					</div><!--end contentSectionContainer-->
					<div class="contentSectionContainer" >
						<span id="footerColumn-3" class="contentSection">
							<h3>Partner Sites</h3>
							<ul>
								<li><a class="footer" href="http://makezine.com/">makezine.com</a></li>
								<li><a class="footer" href="http://makerfaire.com/">makerfaire.com</a></li>
								<li><a class="footer" href="http://craftzine.com/">craftzine.com</a></li>
								<li><a class="footer" href="http://igniteshow.com/">igniteshow.com</a></li>
								<li><a class="footer" href="https://www.x.com/community/ppx/devzone">PayPal Developer Zone</a></li>
								<li><a class="footer" href="http://blogs.forbes.com/oreillymedia/">O'Reilly Insights on Forbes.com</a></li>
							</ul>
						</span>
					</div><!--end contentSectionContainer-->
					<div class="contentSectionContainer" >
						<span id="footerColumn-4" class="contentSection">
							<h3>Shop O'Reilly</h3>
							<ul>
								<li><a class="footer" href="http://shop.oreilly.com/category/customer-service.do">Customer Service</a></li>
								<li><a class="footer" href="http://shop.oreilly.com/category/customer-service.do">Contact Us</a></li>
								<li><a class="footer" href="http://shop.oreilly.com/category/customer-service/shipping-information.do">Shipping Information</a></li>
								<li><a class="footer" href="http://shop.oreilly.com/category/customer-service/ordering-payment.do">Ordering &amp; Payment</a></li>							
								<li><a class="footer" href="http://shop.oreilly.com/category/customer-service/oreilly-guarantee.do">The O'Reilly Guarantee</a></li>
							</ul>
						</span>
					</div> <!--end contentSectionContainer-->
					<div style="clear:both;"></div>
				</div><!--end contentSectionBlock-->
			</div><!--end multiColumnFooter-->

<!-- autocomplete scripts - autocomplete_data.js updated 8/23/12 -cp -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/utilities/utilities.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/datasource/datasource-min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/autocomplete/autocomplete-min.js"></script>
<script type="text/javascript" src="//content.atomz.com/sp10049ed9/publish/autocomplete_data.js"></script>  
</td>
</tr>
</table>


<!-- start Vibrant Media IntelliTXT Tooltip style sheet -->

<style type="text/css">
.iTt{
    FONT-FAMILY:       Verdana, Arial, Helvetica;
    FONT-SIZE:         11px;
    FONT-STYLE:        normal;
    FONT-WEIGHT:       normal;
    COLOR:             black;
    BACKGROUND-COLOR:  lightyellow;
    BORDER:            black 1px solid;
    PADDING:           2px;
}
</style>

<!-- end Vibrant Media IntelliTXT style sheet -->

<!-- start Vibrant Media IntelliTXT script section -->
<!-- script type="text/javascript" src="http://onlamp.us.intellitxt.com/intellitxt/front.asp?ipid=2281"></script -->
<!-- end Vibrant Media IntelliTXT script section -->


<!--Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/
javascript">
</script>
<script type="text/javascript">
_uacct = "UA-31074-5";
urchinTracker();
</script></body>


</html>